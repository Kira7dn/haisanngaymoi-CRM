# [x] app\(features)\_shared\_components\chatbot\CRMCopilot.tsx & app\(features)\crm\managements\_components\hooks\useDashboardWidgets.ts & app\(features)\crm\managements\_components\CustomizableDashboardClient.tsx
Chuyá»ƒn `useDashboardWidgets` tá»« **hook React + localStorage** sang **Zustand**, chÃºng ta sáº½ cÃ³ má»™t **global store** cho dashboard widget, Ä‘á»“ng thá»i váº«n há»— trá»£:

* Láº¥y widget tá»« **localStorage** khi khá»Ÿi táº¡o.
* LÆ°u widget vÃ o **localStorage** khi gá»i `saveWidgets`.
* Reset láº¡i layout tá»« **localStorage**.
* KhÃ´ng cáº§n truyá»n `defaultWidgets` báº¯t buá»™c.

DÆ°á»›i Ä‘Ã¢y lÃ  phiÃªn báº£n dÃ¹ng **Zustand + localStorage**:

```ts
import { create } from 'zustand'
import { Widget } from '../GridStackDashboard'

const STORAGE_KEY = 'dashboard-layout'

interface DashboardState {
  widgets: Widget[]
  setWidgets: (widgets: Widget[]) => void
  saveWidgets: (widgets: Widget[]) => void
  resetWidgets: () => void
}

export const useDashboardStore = create<DashboardState>((set, get) => ({
  widgets: [],

  // Chá»‰ cáº­p nháº­t state, khÃ´ng lÆ°u localStorage
  setWidgets: (widgets) => set({ widgets }),

  // LÆ°u state + localStorage
  saveWidgets: (widgets) => {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(widgets))
    set({ widgets })
  },

  // Reset tá»« localStorage
  resetWidgets: () => {
    const savedData = localStorage.getItem(STORAGE_KEY)
    if (savedData) {
      try {
        const savedWidgets: Widget[] = JSON.parse(savedData)
        set({ widgets: savedWidgets })
      } catch (error) {
        console.error('Failed to parse saved dashboard layout:', error)
      }
    } else {
      set({ widgets: [] })
    }
  }
}))

// Helper Ä‘á»ƒ khá»Ÿi táº¡o store tá»« localStorage khi app mount
export const initializeDashboardStore = () => {
  const savedData = localStorage.getItem(STORAGE_KEY)
  if (savedData) {
    try {
      const savedWidgets: Widget[] = JSON.parse(savedData)
      useDashboardStore.getState().setWidgets(savedWidgets)
    } catch (error) {
      console.error('Failed to initialize dashboard store:', error)
    }
  }
}
```

---

### ðŸ”‘ HÆ°á»›ng dáº«n sá»­ dá»¥ng trong component

```ts
"use client"
import { useEffect } from 'react'
import { useDashboardStore, initializeDashboardStore } from './hooks/useDashboardStore'

export default function CustomizableDashboard() {
  const { widgets, saveWidgets, resetWidgets } = useDashboardStore()

  useEffect(() => {
    initializeDashboardStore()
  }, [])

  // Khi kÃ©o tháº£ widget
  const handleLayoutChange = (newWidgets: Widget[]) => {
    saveWidgets(newWidgets) // lÆ°u trá»±c tiáº¿p
  }

  // Khi nháº¥n Cancel
  const handleCancel = () => {
    resetWidgets()
  }

  // Khi nháº¥n Save
  const handleSave = () => {
    saveWidgets(widgets)
  }

  return (
    <div>
      {/* render dashboard */}
    </div>
  )
}
```

# [ ] app\(features)\crm\managements\_components\GridStackDashboard.tsx
Sá»­ dá»¥ng @shared\ui\sidebar.tsx cho Vertical Sidebar, máº·c Ä‘á»‹nh áº©n cÃ¡c widget bÃªn trong groups